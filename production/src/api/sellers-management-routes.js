export const setupSellersManagementRoutes = (app) => {
    app.get('/sellers', (req, res) => {
        res.send(`<\!DOCTYPE html><html><head><meta charset="UTF-8"><title>Gesti√≥n de Vendedores</title><style>*{margin:0;padding:0;box-sizing:border-box}html,body{height:100%}body{font-family:system-ui;background:#f8fafc;display:flex;flex-direction:column}header{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px;display:flex;justify-content:space-between;flex-shrink:0}.container{display:grid;grid-template-columns:260px 1fr;flex:1;overflow:hidden}.sidebar{background:#fff;border-right:1px solid #e0e0e0;padding:20px;overflow-y:auto;flex-shrink:0}.main{padding:28px;overflow-y:auto}.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:28px}.stat-card{background:#fff;border-radius:10px;padding:20px;box-shadow:0 1px 3px rgba(0,0,0,0.1);border-left:4px solid #667eea}.stat-value{font-size:28px;font-weight:700;color:#667eea}.stat-label{font-size:13px;color:#666;margin-top:4px}.card{background:#fff;border-radius:12px;padding:24px;box-shadow:0 1px 3px rgba(0,0,0,0.1)}.sellers-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;margin-top:20px}.seller-card{border:1px solid #e0e0e0;border-radius:10px;padding:20px;transition:all 0.3s}.seller-card:hover{box-shadow:0 8px 16px rgba(0,0,0,0.1);transform:translateY(-2px)}.seller-name{font-size:18px;font-weight:700;margin-bottom:12px}.seller-badge{display:inline-block;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;margin-bottom:12px}.seller-badge.active{background:#dcfce7;color:#166534}.seller-badge.inactive{background:#fee2e2;color:#991b1b}.seller-info{font-size:14px;color:#666;margin:8px 0}.seller-metrics{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin:16px 0;padding:12px;background:#f8fafc;border-radius:8px}.metric{text-align:center}.metric-value{font-size:18px;font-weight:700;color:#667eea}.seller-actions{display:flex;gap:8px;margin-top:16px}.btn{padding:10px 16px;border:none;border-radius:6px;cursor:pointer;font-weight:600;font-size:13px;flex:1;transition:all 0.2s}.btn-primary{background:#667eea;color:#fff}.btn-primary:hover{background:#5568d3}.btn-danger{background:#ef4444;color:#fff}.btn-danger:hover{background:#dc2626}.btn-success{background:#10b981;color:#fff}.btn-success:hover{background:#059669}.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;overflow-y:auto;padding:20px}.modal.active{display:flex}.modal-content{background:#fff;border-radius:12px;padding:24px;max-width:550px;width:100%;max-height:85vh;overflow-y:auto;margin:auto}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;border-bottom:2px solid #f0f0f0;padding-bottom:16px}.modal-header h2{font-size:20px;color:#1e293b}.close-btn{background:none;border:none;font-size:28px;cursor:pointer;color:#94a3b8}.form-section{margin-bottom:24px;padding-bottom:20px;border-bottom:1px solid #f0f0f0}.form-section-title{font-size:14px;font-weight:700;color:#667eea;text-transform:uppercase;margin-bottom:16px;letter-spacing:0.5px}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}.form-row.full{grid-template-columns:1fr}.form-group{margin-bottom:16px}.form-label{display:block;font-weight:600;margin-bottom:8px;font-size:13px;color:#1e293b}.form-label-optional{font-size:11px;color:#94a3b8;font-weight:400;margin-left:4px}.form-input{width:100%;padding:10px 12px;border:1px solid #ccc;border-radius:6px;font-size:14px}.form-input:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.1)}.form-textarea{width:100%;padding:10px 12px;border:1px solid #ccc;border-radius:6px;font-size:14px;resize:vertical;min-height:80px}.toggle-container{display:flex;align-items:center;gap:12px;margin:12px 0}.toggle-switch{width:50px;height:28px;background:#10b981;border-radius:14px;cursor:pointer;position:relative;transition:background 0.3s}.toggle-switch.inactive{background:#ef4444}.toggle-switch div{position:absolute;top:2px;left:24px;width:24px;height:24px;background:#fff;border-radius:50%;transition:left 0.3s}.toggle-switch.inactive div{left:2px}.status-label{font-weight:600;color:#667eea;min-width:80px}.checkbox-group{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.checkbox-item{display:flex;align-items:center;gap:8px}.checkbox-item input{cursor:pointer}.checkbox-item label{cursor:pointer;font-size:13px}.form-actions{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:24px;padding-top:20px;border-top:2px solid #f0f0f0}.alert{padding:12px;border-radius:6px;margin-bottom:16px;font-weight:600}.alert-success{background:#dcfce7;color:#166534;border-left:4px solid #10b981}.alert-error{background:#fee2e2;color:#991b1b;border-left:4px solid #ef4444}.nav-item{display:block;padding:10px;color:#475569;text-decoration:none;border-radius:6px;margin-bottom:4px}.nav-item.active{background:#eef2ff;color:#667eea;font-weight:600}</style></head><body><header><h1>üë• Gesti√≥n de Vendedores</h1><button onclick="logout()" style="background:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer">Cerrar Sesi√≥n</button></header><div class="container"><div class="sidebar"><h3>Men√∫</h3><a href="/dashboard" class="nav-item">üè† Dashboard</a><a href="/sellers" class="nav-item active">üë• Vendedores</a><a href="/seller-availability" class="nav-item">‚è∞ Disponibilidad</a></div><div class="main"><div id="alert"></div><div class="stats-grid"><div class="stat-card"><div class="stat-value" id="s0">-</div><div class="stat-label">Total</div></div><div class="stat-card"><div class="stat-value" id="s1">-</div><div class="stat-label">Activos</div></div><div class="stat-card"><div class="stat-value" id="s2">-</div><div class="stat-label">Asignaciones</div></div><div class="stat-card"><div class="stat-value" id="s3">-</div><div class="stat-label">Conversaciones</div></div></div><div class="card"><h2>üìã Lista de Vendedores</h2><div class="sellers-grid" id="sellers"><p>Cargando...</p></div></div></div></div><div id="editModal" class="modal"><div class="modal-content"><div class="modal-header"><h2>‚úèÔ∏è Editar Vendedor</h2><button class="close-btn" onclick="closeModal()">√ó</button></div><form onsubmit="saveSeller(event)"><div id="alert"></div><div class="form-section"><div class="form-section-title">üìã Informaci√≥n B√°sica</div><div class="form-row full"><div class="form-group"><label class="form-label">Nombre <span class="form-label-optional">(requerido)</span></label><input type="text" id="sellerName" class="form-input" required></div></div><div class="form-row"><div class="form-group"><label class="form-label">Email <span class="form-label-optional">(opcional)</span></label><input type="email" id="sellerEmail" class="form-input"></div><div class="form-group"><label class="form-label">Tel√©fono <span class="form-label-optional">(opcional)</span></label><input type="tel" id="sellerPhone" class="form-input"></div></div></div><div class="form-section"><div class="form-section-title">üíº Informaci√≥n Profesional</div><div class="form-row"><div class="form-group"><label class="form-label">Especialidad <span class="form-label-optional">(opcional)</span></label><input type="text" id="sellerSpecialty" class="form-input" placeholder="ej: Premium, General, Technical"></div><div class="form-group"><label class="form-label">M√°x. Clientes <span class="form-label-optional">(opcional)</span></label><input type="number" id="maxClients" class="form-input" value="10" min="1"></div></div><div class="form-row full"><div class="form-group"><label class="form-label">Notas <span class="form-label-optional">(opcional)</span></label><textarea id="sellerNotes" class="form-textarea" placeholder="Notas adicionales sobre el vendedor..."></textarea></div></div></div><div class="form-section"><div class="form-section-title">‚è∞ Horario y Disponibilidad</div><div class="form-row"><div class="form-group"><label class="form-label">Hora Inicio <span class="form-label-optional">(opcional)</span></label><input type="time" id="workStart" class="form-input"></div><div class="form-group"><label class="form-label">Hora Fin <span class="form-label-optional">(opcional)</span></label><input type="time" id="workEnd" class="form-input"></div></div><div class="form-group"><label class="form-label">D√≠as de Descanso <span class="form-label-optional">(opcional)</span></label><div class="checkbox-group"><label class="checkbox-item"><input type="checkbox" id="dayOff0"> Lunes</label><label class="checkbox-item"><input type="checkbox" id="dayOff1"> Martes</label><label class="checkbox-item"><input type="checkbox" id="dayOff2"> Mi√©rcoles</label><label class="checkbox-item"><input type="checkbox" id="dayOff3"> Jueves</label><label class="checkbox-item"><input type="checkbox" id="dayOff4"> Viernes</label><label class="checkbox-item"><input type="checkbox" id="dayOff5"> S√°bado</label></div></div></div><div class="form-section"><div class="form-section-title">üîî Notificaciones y Estado</div><div class="form-row"><div class="form-group"><label class="form-label">Notificaci√≥n cada (minutos) <span class="form-label-optional">(opcional)</span></label><input type="number" id="notificationInterval" class="form-input" value="30" min="5"></div><div class="form-group"><label class="form-label">Respuesta Promedio (seg) <span class="form-label-optional">(opcional)</span></label><input type="number" id="avgResponse" class="form-input" value="0" min="0"></div></div><div class="form-group"><label class="form-label">Estado del Vendedor</label><div class="toggle-container"><div id="statusToggle" class="toggle-switch" onclick="toggleStatusSwitch()"><div></div></div><span class="status-label" id="statusLabel">Activo</span></div></div></div><div class="form-actions"><button type="submit" class="btn btn-primary">‚úÖ Guardar Cambios</button><button type="button" class="btn btn-danger" onclick="closeModal()">‚ùå Cancelar</button></div></form></div></div><script>let currentSeller=null;let currentStatus='active';function showAlert(msg,type){const alert=document.getElementById('alert');alert.innerHTML=\`<div class="alert alert-\${type}">\${msg}</div>\`;setTimeout(()=>{alert.innerHTML=''},3000)}function load(){fetch('/api/health').then(r=>r.json()).then(d=>{const s=d.sellers?.sellersStats||[];document.getElementById('s0').textContent=s.length;document.getElementById('s1').textContent=s.filter(x=>x.status==='available').length;document.getElementById('s2').textContent=d.sellers?.totalAssignments||0;document.getElementById('s3').textContent=d.sellers?.activeConversations||0;const html=s.map(x=>\`<div class="seller-card"><div class="seller-name">\${x.name}</div><span class="seller-badge \${x.status==='available'?'active':'inactive'}">\${x.status==='available'?'‚úÖ Activo':'‚ùå Inactivo'}</span><div class="seller-info">ID: \${x.id}</div><div class="seller-info">Rating: ‚≠ê\${x.rating.toFixed(1)}</div><div class="seller-metrics"><div class="metric"><div class="metric-value">\${x.currentClients}</div>Clientes</div><div class="metric"><div class="metric-value">\${Math.round(x.currentClients*20)}%</div>Carga</div></div><button class="btn btn-primary" onclick="openEdit('\${x.id}','\${x.name}','\${x.status}')">‚úèÔ∏è Editar</button><button class="btn \${x.status==='available'?'btn-danger':'btn-success'}" onclick="toggleSellerStatus('\${x.id}','\${x.status}')">\${x.status==='available'?'üî¥ Desactivar':'üü¢ Activar'}</button></div>\`).join('');document.getElementById('sellers').innerHTML=html}).catch(e=>{console.error(e);showAlert('Error cargando vendedores','error')})}function openEdit(id,name,status){currentSeller=id;currentStatus=status==='available'?'active':'inactive';document.getElementById('sellerName').value=name;document.getElementById('sellerEmail').value='';document.getElementById('sellerPhone').value='';document.getElementById('sellerSpecialty').value='';document.getElementById('maxClients').value='10';document.getElementById('notificationInterval').value='30';document.getElementById('avgResponse').value='0';document.getElementById('sellerNotes').value='';document.getElementById('workStart').value='';document.getElementById('workEnd').value='';for(let i=0;i<6;i++){document.getElementById('dayOff'+i).checked=false}updateToggleUI();document.getElementById('editModal').classList.add('active')}function closeModal(){document.getElementById('editModal').classList.remove('active')}function toggleStatusSwitch(){const toggle=document.getElementById('statusToggle');const label=document.getElementById('statusLabel');if(currentStatus==='active'){currentStatus='inactive';toggle.classList.add('inactive');label.textContent='Inactivo';label.style.color='#ef4444'}else{currentStatus='active';toggle.classList.remove('inactive');label.textContent='Activo';label.style.color='#667eea'}}function updateToggleUI(){const toggle=document.getElementById('statusToggle');const label=document.getElementById('statusLabel');if(currentStatus==='active'){toggle.classList.remove('inactive');label.textContent='Activo';label.style.color='#667eea'}else{toggle.classList.add('inactive');label.textContent='Inactivo';label.style.color='#ef4444'}}function saveSeller(e){e.preventDefault();const name=document.getElementById('sellerName').value;const email=document.getElementById('sellerEmail').value||'N/A';const phone=document.getElementById('sellerPhone').value||'N/A';const specialty=document.getElementById('sellerSpecialty').value||'General';const maxClients=document.getElementById('maxClients').value||'10';const avgResponse=document.getElementById('avgResponse').value||'0';const notes=document.getElementById('sellerNotes').value||'Sin notas';const workStart=document.getElementById('workStart').value||'N/A';const workEnd=document.getElementById('workEnd').value||'N/A';const daysOff=[];for(let i=0;i<6;i++){if(document.getElementById('dayOff'+i).checked){daysOff.push(['Lunes','Martes','Mi√©rcoles','Jueves','Viernes','S√°bado'][i])}}const data={name,email,phone,specialty,maxClients:parseInt(maxClients),avgResponse:parseInt(avgResponse),notes,workStart,workEnd,daysOff,notificationInterval:document.getElementById('notificationInterval').value,status:currentStatus};fetch(\`/api/seller/\${currentSeller}/update\`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)}).then(r=>r.json()).then(d=>{if(d.success){showAlert(\`‚úÖ Vendedor \${name} actualizado correctamente\`,'success');closeModal();setTimeout(load,500)}else{showAlert(\`‚ùå Error: \${d.error}\`,'error')}}).catch(e=>{console.error(e);showAlert('Error al guardar','error')})}function toggleSellerStatus(id,status){const newStatus=status==='available'?'inactive':'active';const msg=status==='available'?'DESACTIVADO':'ACTIVADO';fetch(\`/api/seller/\${id}/status\`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({status:newStatus})}).then(r=>r.json()).then(d=>{showAlert(\`‚úÖ Vendedor \${msg}\`,d.success?'success':'error');load()}).catch(e=>{console.error(e);showAlert('Error al cambiar estado','error');load()})}function logout(){window.location.href='/login'}load();setInterval(load,30000)</script></body></html>`);
    });

    app.get('/seller-availability', (req, res) => {
        res.send(`<\!DOCTYPE html><html><head><meta charset="UTF-8"><title>Disponibilidad</title><style>*{margin:0;padding:0;box-sizing:border-box}html,body{height:100%}body{font-family:system-ui;background:#f8fafc;display:flex;flex-direction:column}header{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px;display:flex;justify-content:space-between;flex-shrink:0}.container{display:grid;grid-template-columns:260px 1fr;flex:1;overflow:hidden}.sidebar{background:#fff;border-right:1px solid #e0e0e0;padding:20px;overflow-y:auto;flex-shrink:0}.main{padding:28px;overflow-y:auto}.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:28px}.stat-card{background:#fff;border-radius:10px;padding:20px;box-shadow:0 1px 3px rgba(0,0,0,0.1);border-left:4px solid #667eea}.stat-value{font-size:28px;font-weight:700;color:#667eea}.stat-label{font-size:13px;color:#666}.card{background:#fff;border-radius:12px;padding:24px;box-shadow:0 1px 3px rgba(0,0,0,0.1)}.availability-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;margin-top:20px}.avail-card{border:1px solid #e0e0e0;border-radius:10px;padding:20px}.avail-card:hover{box-shadow:0 8px 16px rgba(0,0,0,0.1)}.seller-name{font-size:18px;font-weight:700;margin-bottom:12px}.status-badge{display:inline-block;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;margin-bottom:12px}.status-badge.available{background:#dcfce7;color:#166534}.status-badge.busy{background:#fef3c7;color:#92400e}.status-badge.offline{background:#fee2e2;color:#991b1b}.info-row{display:flex;justify-content:space-between;padding:8px 0;font-size:14px;border-bottom:1px solid #f0f0f0}.nav-item{display:block;padding:10px;color:#475569;text-decoration:none;border-radius:6px;margin-bottom:4px}.nav-item.active{background:#eef2ff;color:#667eea;font-weight:600}</style></head><body><header><h1>‚è∞ Disponibilidad en Tiempo Real</h1><button onclick="logout()" style="background:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer">Cerrar Sesi√≥n</button></header><div class="container"><div class="sidebar"><h3>Men√∫</h3><a href="/dashboard" class="nav-item">üè† Dashboard</a><a href="/sellers" class="nav-item">üë• Vendedores</a><a href="/seller-availability" class="nav-item active">‚è∞ Disponibilidad</a></div><div class="main"><div class="stats-grid"><div class="stat-card"><div class="stat-value" id="t0">-</div><div class="stat-label">Total</div></div><div class="stat-card"><div class="stat-value" id="t1">-</div><div class="stat-label">Disponibles</div></div><div class="stat-card"><div class="stat-value" id="t2">-</div><div class="stat-label">Ocupados</div></div><div class="stat-card"><div class="stat-value" id="t3">-</div><div class="stat-label">Offline</div></div></div><div class="card"><h2>üìä Estado de Vendedores</h2><div class="availability-grid" id="availability"><p>Cargando...</p></div></div></div></div><script>function load(){fetch('/api/health').then(r=>r.json()).then(d=>{const s=d.sellers?.sellersStats||[];const avail=s.filter(x=>x.status==='available').length;const busy=s.filter(x=>x.currentClients>0).length;const offline=s.filter(x=>x.status\!=='available').length;document.getElementById('t0').textContent=s.length;document.getElementById('t1').textContent=avail;document.getElementById('t2').textContent=busy;document.getElementById('t3').textContent=offline;const html=s.map(x=>{const st=x.status==='available'?'available':x.currentClients>0?'busy':'offline';const txt=st==='available'?'‚úÖ Disponible':st==='busy'?'üî¥ Ocupado':'‚ö´ Offline';return\`<div class="avail-card"><div class="seller-name">\${x.name}</div><span class="status-badge \${st}">\${txt}</span><div class="info-row"><span>ID</span><span>\${x.id}</span></div><div class="info-row"><span>Clientes</span><span>\${x.currentClients}</span></div><div class="info-row"><span>Rating</span><span>‚≠ê\${x.rating.toFixed(1)}</span></div><div class="info-row"><span>Carga</span><span>\${Math.round(x.currentClients*20)}%</span></div></div>\`}).join('');document.getElementById('availability').innerHTML=html}).catch(e=>console.error(e))}function logout(){window.location.href='/login'}load();setInterval(load,30000)</script></body></html>`);
    });
};

export default setupSellersManagementRoutes;
