"use strict";(self.webpackChunkcocolu_dashboard=self.webpackChunkcocolu_dashboard||[]).push([[149],{6149:(e,s,a)=>{a.r(s),a.d(s,{default:()=>r});var n=a(5043),t=a(579);function r(){const[e,s]=(0,n.useState)({}),[a,r]=(0,n.useState)(!0),[i,c]=(0,n.useState)(null),[l,o]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[h,m]=(0,n.useState)(""),[g,j]=(0,n.useState)(""),[x,v]=(0,n.useState)("");(0,n.useEffect)(()=>{b()},[]);const b=async()=>{try{r(!0);const e=await fetch("/api/settings"),a=await e.json();a.success?(s(a.settings),c(null)):c(a.error||"Error al cargar configuraci\xf3n")}catch(e){c("Error al conectar con el servidor"),console.error(e)}finally{r(!1)}};return a?(0,t.jsx)("div",{className:"settings-container",children:(0,t.jsx)("div",{className:"loading",children:"Cargando configuraci\xf3n..."})}):(0,t.jsxs)("div",{className:"settings-container",children:[(0,t.jsxs)("div",{className:"settings-header",children:[(0,t.jsx)("h1",{children:"\u2699\ufe0f Configuraci\xf3n del Bot"}),(0,t.jsx)("p",{children:"Gestiona las variables de entorno (.env) del bot"})]}),i&&(0,t.jsx)("div",{className:"alert alert-error",children:i}),l&&(0,t.jsx)("div",{className:"alert alert-success",children:l}),(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h2",{children:"\u2795 Agregar Nueva Variable"}),(0,t.jsxs)("div",{className:"add-setting-form",children:[(0,t.jsx)("input",{type:"text",placeholder:"Nombre de la variable (ej: BOT_ADAPTER)",value:g,onChange:e=>j(e.target.value.toUpperCase()),className:"input-field"}),(0,t.jsx)("input",{type:"text",placeholder:"Valor (ej: meta)",value:x,onChange:e=>v(e.target.value),className:"input-field"}),(0,t.jsx)("button",{onClick:async()=>{if(g.trim()&&x.trim())try{const e=await fetch("/api/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({settings:{[g]:x}})}),s=await e.json();s.success?(o("\u2705 ".concat(g," agregado correctamente")),j(""),v(""),b(),setTimeout(()=>o(null),3e3)):c(s.error||"Error al agregar")}catch(e){c("Error al conectar con el servidor"),console.error(e)}else c("Clave y valor son requeridos")},className:"btn btn-primary",children:"Agregar Variable"})]})]}),(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h2",{children:"\ud83d\udccb Variables Actuales"}),(0,t.jsx)("div",{className:"settings-list",children:0===Object.entries(e).length?(0,t.jsx)("p",{className:"no-settings",children:"No hay variables configuradas"}):Object.entries(e).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-key",children:[(0,t.jsx)("span",{className:"key-name",children:s}),a.isSensitive&&(0,t.jsx)("span",{className:"sensitive-badge",children:"\ud83d\udd12 Sensible"})]}),d===s?(0,t.jsxs)("div",{className:"setting-edit",children:[(0,t.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),className:"input-field",autoFocus:!0}),(0,t.jsx)("button",{onClick:()=>(async(e,s)=>{try{const a=await fetch("/api/settings/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:s})}),n=await a.json();n.success?(o("\u2705 ".concat(e," actualizado correctamente")),u(null),b(),setTimeout(()=>o(null),3e3)):c(n.error||"Error al actualizar")}catch(a){c("Error al conectar con el servidor"),console.error(a)}})(s,h),className:"btn btn-success btn-sm",children:"Guardar"}),(0,t.jsx)("button",{onClick:()=>u(null),className:"btn btn-secondary btn-sm",children:"Cancelar"})]}):(0,t.jsxs)("div",{className:"setting-value",children:[(0,t.jsx)("code",{children:a.value}),(0,t.jsxs)("div",{className:"setting-actions",children:[(0,t.jsx)("button",{onClick:()=>{u(s),m(a.original||a.value)},className:"btn btn-edit btn-sm",children:"\u270f\ufe0f Editar"}),(0,t.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas eliminar ".concat(e,"?")))try{const s=await fetch("/api/settings/".concat(e),{method:"DELETE"}),a=await s.json();a.success?(o("\u2705 ".concat(e," eliminado correctamente")),b(),setTimeout(()=>o(null),3e3)):c(a.error||"Error al eliminar")}catch(s){c("Error al conectar con el servidor"),console.error(s)}})(s),className:"btn btn-danger btn-sm",children:"\ud83d\uddd1\ufe0f Eliminar"})]})]})]},s)})})]}),(0,t.jsxs)("div",{className:"settings-section info-section",children:[(0,t.jsx)("h2",{children:"\u2139\ufe0f Informaci\xf3n Importante"}),(0,t.jsxs)("ul",{className:"info-list",children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"BOT_ADAPTER"}),": Selecciona el adaptador (meta, baileys, etc.)"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"META_JWT_TOKEN"}),": Token de autenticaci\xf3n de Meta Business API"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"META_NUMBER_ID"}),": ID del n\xfamero de WhatsApp Business"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"META_VERIFY_TOKEN"}),": Token para verificar webhooks de Meta"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"PORT"}),": Puerto en el que corre el bot (por defecto 3008)"]}),(0,t.jsx)("li",{className:"warning",children:"\u26a0\ufe0f Los cambios se guardan inmediatamente en el archivo .env"}),(0,t.jsx)("li",{className:"warning",children:"\u26a0\ufe0f Algunos cambios pueden requerir reiniciar el contenedor"})]})]})]})}}}]);
//# sourceMappingURL=149.73dd0f78.chunk.js.map