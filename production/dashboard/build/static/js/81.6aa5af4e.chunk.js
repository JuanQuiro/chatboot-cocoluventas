"use strict";(self.webpackChunkcocolu_dashboard=self.webpackChunkcocolu_dashboard||[]).push([[81],{8081:(e,a,s)=>{s.r(a),s.d(a,{default:()=>n});var l=s(5043),i=s(579);function n(){const[e,a]=(0,l.useState)([]),[s,n]=(0,l.useState)(null),[d,r]=(0,l.useState)(!1),[o,h]=(0,l.useState)(null),[m,j]=(0,l.useState)("available");(0,l.useEffect)(()=>{x();const e=setInterval(x,3e4);return()=>clearInterval(e)},[]);const x=async()=>{try{r(!0);const[e,s]=await Promise.all([fetch("/api/sellers/available"),fetch("/api/sellers/availability/report")]),l=await e.json(),i=await s.json();a(l.sellers||[]),h(i.report)}catch(e){console.error("Error cargando datos:",e)}finally{r(!1)}};return(0,i.jsxs)("div",{className:"seller-availability-container",children:[(0,i.jsxs)("div",{className:"seller-header",children:[(0,i.jsx)("h1",{children:"\ud83d\udc65 Disponibilidad de Vendedores"}),(0,i.jsx)("button",{className:"btn-refresh",onClick:x,disabled:d,children:d?"\u23f3 Cargando...":"\ud83d\udd04 Actualizar"})]}),o&&(0,i.jsxs)("div",{className:"summary-grid",children:[(0,i.jsxs)("div",{className:"summary-card",children:[(0,i.jsx)("div",{className:"summary-value",children:o.total}),(0,i.jsx)("div",{className:"summary-label",children:"Total Vendedores"})]}),(0,i.jsxs)("div",{className:"summary-card active",children:[(0,i.jsx)("div",{className:"summary-value",children:o.workingNow}),(0,i.jsx)("div",{className:"summary-label",children:"Trabajando Ahora"})]}),(0,i.jsxs)("div",{className:"summary-card available",children:[(0,i.jsx)("div",{className:"summary-value",children:o.available}),(0,i.jsx)("div",{className:"summary-label",children:"Disponibles"})]}),(0,i.jsxs)("div",{className:"summary-card offline",children:[(0,i.jsx)("div",{className:"summary-value",children:o.offline}),(0,i.jsx)("div",{className:"summary-label",children:"Offline"})]})]}),(0,i.jsxs)("div",{className:"tabs",children:[(0,i.jsxs)("button",{className:"tab ".concat("available"===m?"active":""),onClick:()=>j("available"),children:["\u2705 Disponibles Ahora (",e.length,")"]}),(0,i.jsx)("button",{className:"tab ".concat("manage"===m?"active":""),onClick:()=>j("manage"),children:"\u2699\ufe0f Gestionar"})]}),"available"===m&&(0,i.jsx)("div",{className:"sellers-grid",children:0===e.length?(0,i.jsx)("div",{className:"empty-state",children:(0,i.jsx)("p",{children:"No hay vendedores disponibles en este momento"})}):e.map(e=>(0,i.jsxs)("div",{className:"seller-card",children:[(0,i.jsxs)("div",{className:"seller-header-card",children:[(0,i.jsx)("h3",{children:e.name}),(0,i.jsx)("span",{className:"badge ".concat(e.status),children:e.status})]}),(0,i.jsxs)("div",{className:"seller-info",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Especialidad:"})," ",e.specialty]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Calificaci\xf3n:"})," \u2b50 ",e.rating.toFixed(1)]}),(0,i.jsx)("div",{className:"load-bar",children:(0,i.jsx)("div",{className:"load-fill",style:{width:"".concat(e.loadPercentage,"%")}})}),(0,i.jsxs)("p",{className:"load-text",children:[e.loadPercentage.toFixed(0),"% ocupado"]})]}),(0,i.jsx)("button",{className:"btn-select",onClick:()=>n(e),children:"Ver Detalles"})]},e.id))}),"manage"===m&&(0,i.jsxs)("div",{className:"manage-section",children:[(0,i.jsx)("h2",{children:"Gestionar Vendedores"}),(0,i.jsx)(t,{onUpdate:x})]}),s&&(0,i.jsx)("div",{className:"modal-overlay",onClick:()=>n(null),children:(0,i.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("button",{className:"btn-close",onClick:()=>n(null),children:"\u2715"}),(0,i.jsx)(c,{seller:s,onUpdate:x})]})})]})}function c(e){let{seller:a,onUpdate:s}=e;const[n,c]=(0,l.useState)(!1),[t,d]=(0,l.useState)(!1),[r,o]=(0,l.useState)(""),[h,m]=(0,l.useState)("");return(0,i.jsxs)("div",{className:"seller-details",children:[(0,i.jsx)("h2",{children:a.name}),(0,i.jsxs)("div",{className:"details-grid",children:[(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("label",{children:"Estado"}),(0,i.jsx)("span",{className:"status-badge ".concat(a.status),children:a.status})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("label",{children:"Especialidad"}),(0,i.jsx)("span",{children:a.specialty})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("label",{children:"Calificaci\xf3n"}),(0,i.jsxs)("span",{children:["\u2b50 ",a.rating.toFixed(1)]})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("label",{children:"Clientes Actuales"}),(0,i.jsxs)("span",{children:[a.currentClients," / ",a.maxClients]})]})]}),(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("h3",{children:"\ud83d\udcc5 Horarios de Trabajo"}),(0,i.jsxs)("button",{className:"btn-toggle",onClick:()=>c(!n),children:[n?"\u25bc":"\u25b6"," Ver Horarios"]}),n&&a.workSchedule&&(0,i.jsx)("div",{className:"schedule-grid",children:Object.entries(a.workSchedule).map(e=>{let[a,s]=e;return(0,i.jsxs)("div",{className:"schedule-item",children:[(0,i.jsx)("h4",{children:a.charAt(0).toUpperCase()+a.slice(1)}),(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:s.enabled,onChange:e=>{}}),"Habilitado"]}),s.enabled&&(0,i.jsxs)("div",{className:"time-inputs",children:[(0,i.jsx)("input",{type:"time",defaultValue:s.startTime,disabled:!0}),(0,i.jsx)("span",{children:"-"}),(0,i.jsx)("input",{type:"time",defaultValue:s.endTime,disabled:!0})]})]},a)})})]}),(0,i.jsxs)("div",{className:"section",children:[(0,i.jsx)("h3",{children:"\ud83c\udfd6\ufe0f D\xedas de Descanso"}),(0,i.jsx)("button",{className:"btn-add",onClick:()=>d(!t),children:"+ Agregar D\xeda de Descanso"}),t&&(0,i.jsxs)("div",{className:"day-off-form",children:[(0,i.jsx)("input",{type:"date",value:r,onChange:e=>o(e.target.value)}),(0,i.jsx)("input",{type:"text",placeholder:"Raz\xf3n (ej: Vacaciones)",value:h,onChange:e=>m(e.target.value)}),(0,i.jsx)("button",{className:"btn-save",onClick:async()=>{if(r)try{(await fetch("/api/sellers/".concat(a.id,"/days-off"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:r,reason:h})})).ok&&(o(""),m(""),d(!1),s(),alert("D\xeda de descanso agregado"))}catch(e){alert("Error: "+e.message)}else alert("Selecciona una fecha")},children:"Guardar"})]}),a.daysOff&&a.daysOff.length>0&&(0,i.jsx)("div",{className:"days-off-list",children:a.daysOff.map((e,a)=>(0,i.jsxs)("div",{className:"day-off-item",children:[(0,i.jsx)("span",{children:new Date(e.date).toLocaleDateString()}),(0,i.jsx)("span",{children:e.reason})]},a))})]})]})}function t(e){let{onUpdate:a}=e;const[s,n]=(0,l.useState)(""),[c,t]=(0,l.useState)(null),[d,r]=(0,l.useState)(!0);return(0,i.jsxs)("div",{className:"manage-form",children:[(0,i.jsxs)("div",{className:"search-box",children:[(0,i.jsx)("input",{type:"text",placeholder:"ID del vendedor",value:s,onChange:e=>n(e.target.value)}),(0,i.jsx)("button",{className:"btn-search",onClick:async()=>{if(s)try{const e=await fetch("/api/sellers/".concat(s,"/status"));if(e.ok){const a=await e.json();t(a.status),r(a.status.active)}else alert("Vendedor no encontrado")}catch(e){alert("Error: "+e.message)}else alert("Ingresa un ID de vendedor")},children:"\ud83d\udd0d Buscar"})]}),c&&(0,i.jsxs)("div",{className:"seller-manage-card",children:[(0,i.jsx)("h3",{children:c.name}),(0,i.jsxs)("div",{className:"manage-info",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Email:"})," ",c.email]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Estado:"})," ",c.status]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Trabajando ahora:"})," ",c.isWorkingNow?"\u2705 S\xed":"\u274c No"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Disponible:"})," ",c.isAvailable?"\u2705 S\xed":"\u274c No"]})]}),(0,i.jsxs)("button",{className:"btn-toggle-status ".concat(d?"active":"inactive"),onClick:async()=>{try{(await fetch("/api/sellers/".concat(s,"/toggle-availability"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:!d,reason:d?"Deshabilitado":null})})).ok&&(r(!d),a(),alert("Estado actualizado"))}catch(e){alert("Error: "+e.message)}},children:[d?"\u2705 Activo":"\u274c Inactivo"," - Cambiar"]})]})]})}}}]);
//# sourceMappingURL=81.6aa5af4e.chunk.js.map