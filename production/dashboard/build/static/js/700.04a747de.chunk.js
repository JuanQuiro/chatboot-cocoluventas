"use strict";(self.webpackChunkcocolu_dashboard=self.webpackChunkcocolu_dashboard||[]).push([[700],{3700:(s,e,a)=>{a.r(e),a.d(e,{default:()=>f});a(5043);var i=a(2532),c=a(4669),r=a(7118),t=a(4919),l=a(5088),d=a(7361),n=a(108),o=a(5748),h=a(7734),m=a(2185),x=a(6026),j=a(6150),u=a(1327),v=a(168),N=a(163),b=a(4240),y=a(7869),p=a(579);const g=["#667eea","#4ade80","#f59e0b","#ef4444","#8b5cf6"];function f(){const{data:s,isLoading:e,error:a}=(0,i.I)({queryKey:["analytics"],queryFn:async()=>{const s=await fetch("/api/analytics/metrics");if(!s.ok)throw new Error("Error cargando analytics");return s.json()},retry:1,staleTime:3e4}),{data:f,isLoading:w}=(0,i.I)({queryKey:["sellers-workload"],queryFn:async()=>{const s=await fetch("/api/sellers/workload");if(!s.ok)throw new Error("Error cargando workload");const e=await s.json();return e.data||e||[]},retry:1,staleTime:3e4});if(e||w)return(0,p.jsxs)("div",{className:"analytics-page loading",children:[(0,p.jsx)("div",{className:"spinner"}),(0,p.jsx)("p",{children:"Cargando analytics..."})]});const k=(null===s||void 0===s?void 0:s.data)||s||{},C=f||[];return(0,p.jsxs)("div",{className:"analytics-page",children:[(0,p.jsx)("div",{className:"page-header",children:(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{children:"\ud83d\udcca Analytics"}),(0,p.jsx)("p",{className:"subtitle",children:"M\xe9tricas y estad\xedsticas del chatbot"})]})}),(0,p.jsxs)("div",{className:"metrics-grid",children:[(0,p.jsxs)("div",{className:"metric-card",children:[(0,p.jsx)("div",{className:"metric-icon messages",children:(0,p.jsx)(c.A,{size:24})}),(0,p.jsxs)("div",{className:"metric-content",children:[(0,p.jsx)("div",{className:"metric-label",children:"Total Mensajes"}),(0,p.jsx)("div",{className:"metric-value",children:k.totalMessages||0})]})]}),(0,p.jsxs)("div",{className:"metric-card",children:[(0,p.jsx)("div",{className:"metric-icon users",children:(0,p.jsx)(r.A,{size:24})}),(0,p.jsxs)("div",{className:"metric-content",children:[(0,p.jsx)("div",{className:"metric-label",children:"Conversaciones Activas"}),(0,p.jsx)("div",{className:"metric-value",children:k.activeConversations||0})]})]}),(0,p.jsxs)("div",{className:"metric-card",children:[(0,p.jsx)("div",{className:"metric-icon rate",children:(0,p.jsx)(t.A,{size:24})}),(0,p.jsxs)("div",{className:"metric-content",children:[(0,p.jsx)("div",{className:"metric-label",children:"Tasa de Respuesta"}),(0,p.jsxs)("div",{className:"metric-value",children:[k.responseRate||0,"%"]})]})]}),(0,p.jsxs)("div",{className:"metric-card",children:[(0,p.jsx)("div",{className:"metric-icon time",children:(0,p.jsx)(l.A,{size:24})}),(0,p.jsxs)("div",{className:"metric-content",children:[(0,p.jsx)("div",{className:"metric-label",children:"Tiempo Promedio"}),(0,p.jsxs)("div",{className:"metric-value",children:[k.avgResponseTime||0,"s"]})]})]})]}),(0,p.jsxs)("div",{className:"chart-section",children:[(0,p.jsxs)("h2",{children:[(0,p.jsx)(d.A,{size:20}),"Carga de Trabajo por Vendedor"]}),C.length>0?(0,p.jsx)("div",{className:"workload-table-container",children:(0,p.jsxs)("table",{className:"workload-table",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:"Vendedor"}),(0,p.jsx)("th",{children:"Clientes Actuales"}),(0,p.jsx)("th",{children:"Capacidad M\xe1xima"}),(0,p.jsx)("th",{children:"Carga (%)"}),(0,p.jsx)("th",{children:"Estado"})]})}),(0,p.jsx)("tbody",{children:C.map(s=>{const e=parseFloat(s.load)||0;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"seller-name",children:s.name}),(0,p.jsx)("td",{className:"text-center",children:s.currentClients||0}),(0,p.jsx)("td",{className:"text-center",children:s.maxClients||10}),(0,p.jsx)("td",{children:(0,p.jsxs)("div",{className:"load-bar-container",children:[(0,p.jsx)("div",{className:"load-bar",style:{width:"".concat(Math.min(e,100),"%"),backgroundColor:e>=80?"#ef4444":e>=50?"#f59e0b":"#4ade80"}}),(0,p.jsxs)("span",{className:"load-text",children:[e.toFixed(1),"%"]})]})}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{className:"status-badge ".concat(s.status),children:"available"===s.status?"Disponible":"busy"===s.status?"Ocupado":"Offline"})})]},s.id)})})]})}):(0,p.jsx)("div",{className:"empty-chart",children:(0,p.jsx)("p",{children:"No hay datos de carga de trabajo disponibles"})})]}),k.hourlyDistribution&&(0,p.jsxs)("div",{className:"chart-section",children:[(0,p.jsx)("h2",{children:"\ud83d\udcc8 Distribuci\xf3n por Hora"}),(0,p.jsx)(n.u,{width:"100%",height:300,children:(0,p.jsxs)(o.b,{data:k.hourlyDistribution,children:[(0,p.jsx)(h.d,{strokeDasharray:"3 3"}),(0,p.jsx)(m.W,{dataKey:"hour"}),(0,p.jsx)(x.h,{}),(0,p.jsx)(j.m,{}),(0,p.jsx)(u.s,{}),(0,p.jsx)(v.N,{type:"monotone",dataKey:"messages",stroke:"#667eea",name:"Mensajes",strokeWidth:2})]})})]}),k.categoryDistribution&&(0,p.jsxs)("div",{className:"chart-section",children:[(0,p.jsx)("h2",{children:"\ud83d\uddc2\ufe0f Por Categor\xeda"}),(0,p.jsx)(n.u,{width:"100%",height:300,children:(0,p.jsxs)(N.r,{children:[(0,p.jsx)(b.F,{data:k.categoryDistribution,dataKey:"count",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:!0,children:k.categoryDistribution.map((s,e)=>(0,p.jsx)(y.f,{fill:g[e%g.length]},"cell-".concat(e)))}),(0,p.jsx)(j.m,{}),(0,p.jsx)(u.s,{})]})})]})]})}}}]);
//# sourceMappingURL=700.04a747de.chunk.js.map