{"version":3,"file":"static/js/700.04a747de.chunk.js","mappings":"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","sources":["pages/Analytics.jsx"],"sourcesContent":["import React from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { TrendingUp, Users, MessageSquare, Clock, BarChart3 } from 'lucide-react';\nimport { BarChart, Bar, LineChart, Line, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport '../styles/Analytics.css';\n\nconst COLORS = ['#667eea', '#4ade80', '#f59e0b', '#ef4444', '#8b5cf6'];\n\nexport default function Analytics() {\n    // Fetch analytics metrics\n    const { data: analytics, isLoading, error } = useQuery({\n        queryKey: ['analytics'],\n        queryFn: async () => {\n            const res = await fetch('/api/analytics/metrics');\n            if (!res.ok) throw new Error('Error cargando analytics');\n            return res.json();\n        },\n        retry: 1,\n        staleTime: 30000 // 30 seconds\n    });\n\n    // Sellers workload - separate query\n    const { data: workload, isLoading: workloadLoading } = useQuery({\n        queryKey: ['sellers-workload'],\n        queryFn: async () => {\n            const res = await fetch('/api/sellers/workload');\n            if (!res.ok) throw new Error('Error cargando workload');\n            const data = await res.json();\n            return data.data || data || [];\n        },\n        retry: 1,\n        staleTime: 30000\n    });\n\n    if (isLoading || workloadLoading) {\n        return (\n            <div className=\"analytics-page loading\">\n                <div className=\"spinner\"></div>\n                <p>Cargando analytics...</p>\n            </div>\n        );\n    }\n\n    const metrics = analytics?.data || analytics || {};\n    const sellersData = workload || [];\n\n    return (\n        <div className=\"analytics-page\">\n            <div className=\"page-header\">\n                <div>\n                    <h1>üìä Analytics</h1>\n                    <p className=\"subtitle\">M√©tricas y estad√≠sticas del chatbot</p>\n                </div>\n            </div>\n\n            {/* Summary Cards */}\n            <div className=\"metrics-grid\">\n                <div className=\"metric-card\">\n                    <div className=\"metric-icon messages\">\n                        <MessageSquare size={24} />\n                    </div>\n                    <div className=\"metric-content\">\n                        <div className=\"metric-label\">Total Mensajes</div>\n                        <div className=\"metric-value\">{metrics.totalMessages || 0}</div>\n                    </div>\n                </div>\n\n                <div className=\"metric-card\">\n                    <div className=\"metric-icon users\">\n                        <Users size={24} />\n                    </div>\n                    <div className=\"metric-content\">\n                        <div className=\"metric-label\">Conversaciones Activas</div>\n                        <div className=\"metric-value\">{metrics.activeConversations || 0}</div>\n                    </div>\n                </div>\n\n                <div className=\"metric-card\">\n                    <div className=\"metric-icon rate\">\n                        <TrendingUp size={24} />\n                    </div>\n                    <div className=\"metric-content\">\n                        <div className=\"metric-label\">Tasa de Respuesta</div>\n                        <div className=\"metric-value\">{metrics.responseRate || 0}%</div>\n                    </div>\n                </div>\n\n                <div className=\"metric-card\">\n                    <div className=\"metric-icon time\">\n                        <Clock size={24} />\n                    </div>\n                    <div className=\"metric-content\">\n                        <div className=\"metric-label\">Tiempo Promedio</div>\n                        <div className=\"metric-value\">{metrics.avgResponseTime || 0}s</div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Sellers Workload Table */}\n            <div className=\"chart-section\">\n                <h2>\n                    <BarChart3 size={20} />\n                    Carga de Trabajo por Vendedor\n                </h2>\n                {sellersData.length > 0 ? (\n                    <div className=\"workload-table-container\">\n                        <table className=\"workload-table\">\n                            <thead>\n                                <tr>\n                                    <th>Vendedor</th>\n                                    <th>Clientes Actuales</th>\n                                    <th>Capacidad M√°xima</th>\n                                    <th>Carga (%)</th>\n                                    <th>Estado</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {sellersData.map(seller => {\n                                    const loadPercent = parseFloat(seller.load) || 0;\n                                    return (\n                                        <tr key={seller.id}>\n                                            <td className=\"seller-name\">{seller.name}</td>\n                                            <td className=\"text-center\">{seller.currentClients || 0}</td>\n                                            <td className=\"text-center\">{seller.maxClients || 10}</td>\n                                            <td>\n                                                <div className=\"load-bar-container\">\n                                                    <div\n                                                        className=\"load-bar\"\n                                                        style={{\n                                                            width: `${Math.min(loadPercent, 100)}%`,\n                                                            backgroundColor: loadPercent >= 80 ? '#ef4444' : loadPercent >= 50 ? '#f59e0b' : '#4ade80'\n                                                        }}\n                                                    ></div>\n                                                    <span className=\"load-text\">{loadPercent.toFixed(1)}%</span>\n                                                </div>\n                                            </td>\n                                            <td>\n                                                <span className={`status-badge ${seller.status}`}>\n                                                    {seller.status === 'available' ? 'Disponible' :\n                                                        seller.status === 'busy' ? 'Ocupado' : 'Offline'}\n                                                </span>\n                                            </td>\n                                        </tr>\n                                    );\n                                })}\n                            </tbody>\n                        </table>\n                    </div>\n                ) : (\n                    <div className=\"empty-chart\">\n                        <p>No hay datos de carga de trabajo disponibles</p>\n                    </div>\n                )}\n            </div>\n\n            {/* Charts if data available */}\n            {metrics.hourlyDistribution && (\n                <div className=\"chart-section\">\n                    <h2>üìà Distribuci√≥n por Hora</h2>\n                    <ResponsiveContainer width=\"100%\" height={300}>\n                        <LineChart data={metrics.hourlyDistribution}>\n                            <CartesianGrid strokeDasharray=\"3 3\" />\n                            <XAxis dataKey=\"hour\" />\n                            <YAxis />\n                            <Tooltip />\n                            <Legend />\n                            <Line type=\"monotone\" dataKey=\"messages\" stroke=\"#667eea\" name=\"Mensajes\" strokeWidth={2} />\n                        </LineChart>\n                    </ResponsiveContainer>\n                </div>\n            )}\n\n            {metrics.categoryDistribution && (\n                <div className=\"chart-section\">\n                    <h2>üóÇÔ∏è Por Categor√≠a</h2>\n                    <ResponsiveContainer width=\"100%\" height={300}>\n                        <PieChart>\n                            <Pie\n                                data={metrics.categoryDistribution}\n                                dataKey=\"count\"\n                                nameKey=\"name\"\n                                cx=\"50%\"\n                                cy=\"50%\"\n                                outerRadius={100}\n                                label\n                            >\n                                {metrics.categoryDistribution.map((entry, index) => (\n                                    <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                                ))}\n                            </Pie>\n                            <Tooltip />\n                            <Legend />\n                        </PieChart>\n                    </ResponsiveContainer>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":["COLORS","Analytics","data","analytics","isLoading","error","useQuery","queryKey","queryFn","async","res","fetch","ok","Error","json","retry","staleTime","workload","workloadLoading","_jsxs","className","children","_jsx","metrics","sellersData","MessageSquare","size","totalMessages","Users","activeConversations","TrendingUp","responseRate","Clock","avgResponseTime","BarChart3","length","map","seller","loadPercent","parseFloat","load","name","currentClients","maxClients","style","width","concat","Math","min","backgroundColor","toFixed","status","id","hourlyDistribution","ResponsiveContainer","height","LineChart","CartesianGrid","strokeDasharray","XAxis","dataKey","YAxis","Tooltip","Legend","Line","type","stroke","strokeWidth","categoryDistribution","PieChart","Pie","nameKey","cx","cy","outerRadius","label","entry","index","Cell","fill"],"sourceRoot":""}