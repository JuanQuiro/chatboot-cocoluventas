/*! For license information please see 903.bf066799.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkcocolu_dashboard=self.webpackChunkcocolu_dashboard||[]).push([[903],{2903:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var i=t(2555),n=t(5043),a=t(7701),o=t(4319),r=t(9875),l=t(8995);const c=(0,l.A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),d=(0,l.A)("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),h=(0,l.A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);var u=t(3768),p=t(579);function v(){const{config:e,saveConfig:s,testMessage:t,isSaving:l,isTesting:v}=(0,a.Vp)(),[m,x]=n.useState({});n.useEffect(()=>{e&&x(e)},[e]);const f=(e,s)=>{navigator.clipboard.writeText(e),u.Ay.success("\u2705 ".concat(s," copiado"))};if(!e)return(0,p.jsxs)("div",{className:"meta-setup loading",children:[(0,p.jsx)("div",{className:"spinner"}),(0,p.jsx)("p",{children:"Cargando configuraci\xf3n..."})]});const A=m.jwtToken&&m.numberId&&m.businessId;return(0,p.jsxs)("div",{className:"meta-setup",children:[(0,p.jsxs)("div",{className:"page-header",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{children:"\ud83c\udf10 Configuraci\xf3n Meta WhatsApp"}),(0,p.jsx)("p",{className:"subtitle",children:"WhatsApp Business API Setup"})]}),(0,p.jsx)("div",{className:"header-badge",children:A?(0,p.jsxs)("span",{className:"status-badge configured",children:[(0,p.jsx)(o.A,{size:16}),"Configurado"]}):(0,p.jsxs)("span",{className:"status-badge missing",children:[(0,p.jsx)(r.A,{size:16}),"Sin configurar"]})})]}),(0,p.jsxs)("div",{className:"info-section",children:[(0,p.jsxs)("div",{className:"info-card webhook",children:[(0,p.jsx)("div",{className:"info-label",children:"Webhook URL para Meta"}),(0,p.jsxs)("div",{className:"info-value-group",children:[(0,p.jsx)("code",{className:"info-value",children:m.webhookUrl}),(0,p.jsx)("button",{onClick:()=>f(m.webhookUrl,"Webhook URL"),className:"btn-copy",children:(0,p.jsx)(c,{size:16})})]}),(0,p.jsx)("p",{className:"info-help",children:"Configura este URL en Meta Developers"})]}),(0,p.jsxs)("div",{className:"info-card token",children:[(0,p.jsx)("div",{className:"info-label",children:"Verify Token"}),(0,p.jsxs)("div",{className:"info-value-group",children:[(0,p.jsx)("code",{className:"info-value",children:m.verifyToken}),(0,p.jsx)("button",{onClick:()=>f(m.verifyToken,"Verify Token"),className:"btn-copy",children:(0,p.jsx)(c,{size:16})})]}),(0,p.jsx)("p",{className:"info-help",children:"Usa este token para verificar el webhook"})]})]}),(0,p.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s(m)},className:"config-form",children:[(0,p.jsxs)("div",{className:"form-section",children:[(0,p.jsx)("h2",{children:"\ud83d\udcdd Credenciales Meta"}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"JWT Token (Access Token)"}),(0,p.jsx)("input",{type:"password",value:m.jwtToken||"",onChange:e=>x((0,i.A)((0,i.A)({},m),{},{jwtToken:e.target.value})),placeholder:"EAAxxxxxxxxxxxxx...",className:"form-input"}),(0,p.jsx)("span",{className:"help-text",children:"Obt\xe9n tu Access Token desde Meta Developers \u2192 App Settings"})]}),(0,p.jsxs)("div",{className:"form-row",children:[(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Phone Number ID"}),(0,p.jsx)("input",{type:"text",value:m.numberId||"",onChange:e=>x((0,i.A)((0,i.A)({},m),{},{numberId:e.target.value})),placeholder:"123456789012345",className:"form-input"})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"Business Account ID"}),(0,p.jsx)("input",{type:"text",value:m.businessId||"",onChange:e=>x((0,i.A)((0,i.A)({},m),{},{businessId:e.target.value})),placeholder:"987654321098765",className:"form-input"})]})]}),(0,p.jsxs)("div",{className:"form-row",children:[(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"API Version"}),(0,p.jsxs)("select",{value:m.apiVersion||"v22.0",onChange:e=>x((0,i.A)((0,i.A)({},m),{},{apiVersion:e.target.value})),className:"form-input",children:[(0,p.jsx)("option",{value:"v18.0",children:"v18.0"}),(0,p.jsx)("option",{value:"v19.0",children:"v19.0"}),(0,p.jsx)("option",{value:"v20.0",children:"v20.0"}),(0,p.jsx)("option",{value:"v21.0",children:"v21.0"}),(0,p.jsx)("option",{value:"v22.0",children:"v22.0 (Latest)"})]})]}),(0,p.jsxs)("div",{className:"form-group",children:[(0,p.jsx)("label",{children:"N\xfamero de Tel\xe9fono (para pruebas)"}),(0,p.jsx)("input",{type:"tel",value:m.phoneNumber||"",onChange:e=>x((0,i.A)((0,i.A)({},m),{},{phoneNumber:e.target.value})),placeholder:"+1xxxxxxxxxx",className:"form-input"})]})]})]}),(0,p.jsx)("div",{className:"form-actions",children:(0,p.jsxs)("div",{className:"actions-right",children:[(0,p.jsxs)("button",{type:"button",onClick:()=>{t({to:m.phoneNumber,message:"\ud83e\uddea Test desde Dashboard - "+(new Date).toLocaleString()})},disabled:!A||v,className:"btn-test",children:[(0,p.jsx)(d,{size:16}),v?"Enviando...":"Enviar Test"]}),(0,p.jsxs)("button",{type:"submit",disabled:l,className:"btn-save",children:[(0,p.jsx)(h,{size:16}),l?"Guardando...":"Guardar Configuraci\xf3n"]})]})})]}),(0,p.jsxs)("div",{className:"instructions-section",children:[(0,p.jsx)("h2",{children:"\ud83d\udcd6 Instrucciones"}),(0,p.jsxs)("ol",{className:"instructions-list",children:[(0,p.jsxs)("li",{children:["Ve a ",(0,p.jsx)("a",{href:"https://developers.facebook.com",target:"_blank",rel:"noopener noreferrer",children:"Meta Developers"})]}),(0,p.jsx)("li",{children:"Selecciona tu App de WhatsApp Business API"}),(0,p.jsx)("li",{children:'En "WhatsApp" \u2192 "Configuration", configura el Webhook URL y Verify Token'}),(0,p.jsx)("li",{children:'Copia tu Access Token desde "App Settings" \u2192 "Basic"'}),(0,p.jsx)("li",{children:"Obt\xe9n tu Phone Number ID y Business Account ID"}),(0,p.jsx)("li",{children:"P\xe9galos aqu\xed y guarda la configuraci\xf3n"}),(0,p.jsx)("li",{children:"Haz una prueba enviando un mensaje de test"})]})]})]})}},4319:(e,s,t)=>{t.d(s,{A:()=>i});const i=(0,t(8995).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},7701:(e,s,t)=>{t.d(s,{Wz:()=>T,Vp:()=>w});var i,n,a,o,r,l=t(3248),c=t(2532),d=t(2555),h=t(5043),u=t(9790),p=t(5149),v=t(8458),m=t(6562),x=t(4558),f=t(5239),A=t(1454),j=t(329),g=t(9723),b=(i=new WeakMap,n=new WeakMap,a=new WeakMap,o=new WeakMap,r=new WeakSet,class extends j.Q{constructor(e,s){super(),(0,u.A)(this,r),(0,p.A)(this,i,void 0),(0,p.A)(this,n,void 0),(0,p.A)(this,a,void 0),(0,p.A)(this,o,void 0),(0,x.A)(i,this,e),this.setOptions(s),this.bindMethods(),(0,m.A)(r,this,y).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var s;const t=this.options;this.options=(0,v.A)(i,this).defaultMutationOptions(e),(0,g.f8)(this.options,t)||(0,v.A)(i,this).getMutationCache().notify({type:"observerOptionsUpdated",mutation:(0,v.A)(a,this),observer:this}),null!==t&&void 0!==t&&t.mutationKey&&this.options.mutationKey&&(0,g.EN)(t.mutationKey)!==(0,g.EN)(this.options.mutationKey)?this.reset():"pending"===(null===(s=(0,v.A)(a,this))||void 0===s?void 0:s.state.status)&&(0,v.A)(a,this).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(null===(e=(0,v.A)(a,this))||void 0===e||e.removeObserver(this))}onMutationUpdate(e){(0,m.A)(r,this,y).call(this),(0,m.A)(r,this,k).call(this,e)}getCurrentResult(){return(0,v.A)(n,this)}reset(){var e;null===(e=(0,v.A)(a,this))||void 0===e||e.removeObserver(this),(0,x.A)(a,this,void 0),(0,m.A)(r,this,y).call(this),(0,m.A)(r,this,k).call(this)}mutate(e,s){var t;return(0,x.A)(o,this,s),null===(t=(0,v.A)(a,this))||void 0===t||t.removeObserver(this),(0,x.A)(a,this,(0,v.A)(i,this).getMutationCache().build((0,v.A)(i,this),this.options)),(0,v.A)(a,this).addObserver(this),(0,v.A)(a,this).execute(e)}});function y(){var e,s;const t=null!==(e=null===(s=(0,v.A)(a,this))||void 0===s?void 0:s.state)&&void 0!==e?e:(0,f.$)();(0,x.A)(n,this,(0,d.A)((0,d.A)({},t),{},{isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}))}function k(e){A.jG.batch(()=>{if((0,v.A)(o,this)&&this.hasListeners()){const u=(0,v.A)(n,this).variables,p=(0,v.A)(n,this).context,m={client:(0,v.A)(i,this),meta:this.options.meta,mutationKey:this.options.mutationKey};var s,t,a,r;if("success"===(null===e||void 0===e?void 0:e.type))null===(s=(t=(0,v.A)(o,this)).onSuccess)||void 0===s||s.call(t,e.data,u,p,m),null===(a=(r=(0,v.A)(o,this)).onSettled)||void 0===a||a.call(r,e.data,null,u,p,m);else if("error"===(null===e||void 0===e?void 0:e.type)){var l,c,d,h;null===(l=(c=(0,v.A)(o,this)).onError)||void 0===l||l.call(c,e.error,u,p,m),null===(d=(h=(0,v.A)(o,this)).onSettled)||void 0===d||d.call(h,void 0,e.error,u,p,m)}}this.listeners.forEach(e=>{e((0,v.A)(n,this))})})}function N(e,s){const t=(0,l.jE)(s),[i]=h.useState(()=>new b(t,e));h.useEffect(()=>{i.setOptions(e)},[i,e]);const n=h.useSyncExternalStore(h.useCallback(e=>i.subscribe(A.jG.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),a=h.useCallback((e,s)=>{i.mutate(e,s).catch(g.lQ)},[i]);if(n.error&&(0,g.GU)(i.options.throwOnError,[n.error]))throw n.error;return(0,d.A)((0,d.A)({},n),{},{mutate:a,mutateAsync:n.mutate})}var C=t(6305),M=t(3768);function w(){const e=(0,l.jE)(),{data:s,isLoading:t,error:i}=(0,c.I)({queryKey:["meta-config"],queryFn:C.O.getConfig,staleTime:3e4}),n=N({mutationFn:C.O.saveConfig,onSuccess:()=>{e.invalidateQueries(["meta-config"]),M.Ay.success("\u2705 Configuraci\xf3n guardada")},onError:e=>{var s,t;M.Ay.error((null===(s=e.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.error)||"Error guardando configuraci\xf3n")}}),a=N({mutationFn:C.O.testMessage,onSuccess:()=>{M.Ay.success("\u2705 Mensaje de prueba enviado")},onError:e=>{var s,t;M.Ay.error((null===(s=e.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.error)||"Error enviando test")}});return{config:s,isLoading:t,error:i,saveConfig:n.mutate,testMessage:a.mutate,isSaving:n.isPending,isTesting:a.isPending}}function T(){return(0,c.I)({queryKey:["health"],queryFn:C.HN.getHealth,refetchInterval:3e4,staleTime:1e4})}},9875:(e,s,t)=>{t.d(s,{A:()=>i});const i=(0,t(8995).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}}]);
//# sourceMappingURL=903.bf066799.chunk.js.map